<!DOCTYPE html>
<html lang="ru">

<head>
  <title>Мой Справочник | PHP | Docker</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="../js/jquery-3.1.0.min.js"></script>
  <link rel="stylesheet" type="text/css" href="../css/layout.css">
  <style>
    .footer {
      position: fixed;
      width: 100%;
      left: 0;
      bottom: 0;
    }
    code {
      font-size: 14px !important;
    }
    th {
      color: #fff;
      font-size: 20px;
    }
  </style>
</head>

<body>
  <div class="header">
    <div class="layout-positioner clearfix">
      <div class="header-title">
        <strong>
          <a href="../index.html">Справочник DESIGN/HTML/CSS</a>
        </strong>
      </div>
      <div class="header-logo"></div>
      <ul class="header-menu">
        <li>
          <a href="../index.html             ">Главная</a>
        </li>
        <li>
          <a href="../design-page.html       ">WEB-DESIGN</a>
        </li>
        <li>
          <a href="../html-page.html         ">HTML</a>
        </li>
        <li>
          <a href="../css-page.html          ">CSS</a>
        </li>
        <li>
          <a href="../css3-page.html         ">CSS3</a>
        </li>
        <li>
          <a href="../javascript-page.html   ">jQ</a>
        </li>
        <li>
          <a class="active" href="../php.html">PHP</a>
        </li>
      </ul>
    </div>
  </div>

  <div class="layout-positioner clearfix">
    <div class="vert-menu-cont">
      <ul class="vert-menu">
        <li>
          <a href="php-lang.html               ">Язык PHP</a>
        </li>
        <li>
          <a href="echo.html                   ">Вывод данных</a>
        </li>
        <li>
          <a href="vars.html                   ">Переменные</a>
        </li>
        <li>
          <a href="if-else.html                ">Условные<br>операторы</a>
        </li>
        <li>
          <a href="cicles.html                 ">Циклы</a>
        </li>
        <li>
          <a href="arrayd.html                 ">Массивы</a>
        </li>
        <li>
          <a href="functionss.html             ">Функции</a>
        </li>
        <li>
          <a href="forms.html                  ">Формы</a>
        </li>
        <li>
          <a href="post.html                   ">Почта</a>
        </li>
        <li>
          <a href="yii.html                    ">Yii2</a>
        </li>
        <li>
          <a href="cms.html                    ">CMS</a>
        </li>
        <li>
          <a href="sql.html                    ">SQL</a>
        </li>
        <li>
          <a class="active" href="docker.html  ">Docker</a>
        </li>
        <li>
          <a href="console.html                ">Консоль</a>
        </li>
      </ul>


    </div>
    <div class="content clearfix">

      <h2>Мой Справочник | PHP | Docker</h2>

      <div class="container-fluid">
        <div class="row">
          <table class="new-table">
            <tr>
              <th colspan="3">Установка на Linux</th>
            </tr>

            <tr>
              <td>Установка на <b>Linux</b></td>
              <td>
                <h2>Установка Docker</h2><hr>
                <h3>1 вариант (Edge):</h3>
                <code><mark>curl -sSL https://get.docker.com/ | sh</mark></code><br><br>
                <h3>2 вариант:</h3>
                <p>Скрипт для установки на Linux: <a href="https://get.docker.com/" target="_blank" rel="noopener noreferrer">http://get.docker.com</a></p>
                <p>Копируем <code>curl -fsSL get.docker.com -o get-docker.sh</code>, <br> запускаем-сохраняем-выполняем скрипт </p>
                <code>sh get-docker.sh</code><br>
                <h3>Добавить Docker в группу</h3>
                <code>sudo usermod -aG docker effectiveuser</code> <br>
                <code>whoami</code> <hr>
                <h3>Проверка установки:</h3>
                <code><mark>docker version || sudo docker version</mark></code> <hr>
                <h3>Нужно залогиниться:</h3>
                <code>docker login</code>
                <p>Ввести логин и пароль от Docker Hub</p>
              </td>
              <td><a href="https://docs.docker.com/" target="_blank">Docker-Docs</a> <br>
              Docker контейнер - это не ВМ, это процесс который запускается в фоне
              </td>
            </tr>

            <tr style="background: #ccc;">
              <td>3 вариант (c docker-compose)</td>
              <td><code>sh install.sh</code></td>
              <td>
                <a href="../files/install.sh" download>install.sh</a>
              </td>
            </tr>

            <tr>
                <td>Docker-machine</td>
                <td>
                  <h2>Установка docker-machine</h2> <hr>
                  <code>https://github.com/docker/machine/releases</code> <br>
                  ... выбрать последний релиз ... <br>
                  ... скопировать скрипт ... <br>
                  ... <code>sudo -i</code> и установить скрипт... <br>
                  <code><mark>docker-machine -v</mark></code>
                </td>
                <td>Docs: https://docs.docker.com/machine/install-machine/</td>
              </tr>

              <tr>
                <td>Docker-compose</td>
                <td>
                  <h2>Установка docker-compose</h2> <hr>
                  <code>https://github.com/docker/compose/releases</code> <br>
                  ... выбрать последний релиз ... <br>
                  ... скопировать скрипт ... <br>
                  ... <code>sudo -i</code> и установить скрипт... <br>
                  <code><mark>docker-compose -v</mark></code>
                </td>
                <td>Docs: https://docs.docker.com/compose/install/</td>
              </tr>


            <tr>
              <th colspan="3">Установка на Windows</th>
            </tr>
            <tr>
              <td>Установка на <b>Windows</b></td>
              <td>Устанавливаем Docker-Desktop CE для Windows <a target="_blank" href="https://www.docker.com/products/docker-desktop">Docker-desktop.</a>
              <p>Параметры виртуализации настраиваются в программе <b>Hyper-V Manager</b></p>

              <p>Устанавливаем <a href="https://docs.docker.com/toolbox/toolbox_install_windows/" target="_blank">Docker-toolbox</a></p>
              <code>doc ker-machine start</code><br>
              <code>docker-machine env default</code><br>
              <code>docker-machine env default</code><br>
              </td>
              <td>Для работы в Windows Docker требует поддержку виртуализации. Включается в настройках BIOS</td>
            </tr>

            <tr>
              <th colspan="3">Установка на Mac OS</th>
            </tr>
            <tr>
              <td>Установка на <b>Mac OS</b></td>
              <td><a href="https://store.docker.com/editions/community/docker-ce-desktop-mac" target="_blank">Download desktop app</a> <br>
              <h3>bash-completion</h3>
              <code>brew install bash-completion</code> <hr>
              <code style="font-size: 10px !important;">sudo curl -L https://raw.githubusercontent.com/docker/machine/v0.16.0/contrib/completion/bash/docker-machine.bash -o `brew --prefix`/etc/bash_completion.d/docker-machine</code> <hr>
              <code>docker Tab x2</code>
              </td>
              <td></td>
            </tr>

            <tr>
              <th colspan="3">Запуск контейнеров</th>
            </tr>

            <tr>
              <td><h2>Контейнер-сервер</h2></td>
              <td>
                <code>sudo docker run --name docker-nginx -p 80:80 nginx</code> <hr>
                <b>docker run nginx</b> - какой контейнер создаем и запускаем (будет скачан с DockerHub)
                <p>Будет присвоен uniq id</p>
                <b>--name docker-nginx</b> - кастомное имя, которое мы присваиваем контейнеру<br><br>
                <b>-p 80:80</b> - порт (localhost или 0.0.0.0:80) <hr>

                <h4>Запуск в фоне (флаг -d)</h4>
                <code>sudo docker run --name docker-nginx -p 80:80 <mark>--detach (-d)</mark> nginx</code><hr>

                <h4>Список запущенных контейнеров (всех):</h4>
                <code>docker container <mark>ls</mark> (-a)</code><br>
                <code>docker <mark>ps</mark> (-a)</code><hr>

                <h4>Запуск\остановка контейнера:</h4>
                <code>docker container <mark>run\stop</mark> CONTAINER_ID</code><hr>

                <h4>Удаление контейнера:</h4>
                <p>Запущенный контейнер можно удалить только с <code>-f</code></p>

                <code>docker container <mark>rm</mark> CONTAINER_ID</code> <br>
                <code>docker container <mark>rm -f</mark> CONTAINER_ID</code><hr>

                <h4>Логи:</h4>
                <code>docker container <mark>logs</mark> cont_name</code>
                <hr>
                <h4>Набор контейнеров для веб-сервера</h4>
                <ul>
                  <li>Название | Порт</li>
                  <li>nginx (80:80)</li>
                  <li>httpd (8080:80 apache HTTP server)</li>
                  <li>mysql (3306:3306) (install with -e flag)</li>
                  <li><code>-d -p 3306:3306 --name db -e MYSQL_RANDOM_ROOT_PASSWORD=yes</code></li>
                </ul> <hr>
                <h4>Как зайти в запущенный контейнер через терминал</h4>
                <code>docker container <mark>exec -it cont_name bash</mark></code>
              </td>
              <td>
                Когда запускаем команду <code>run container</code>
                <ol>
                  <li>Локальный поиск этого образа</li>
                  <li>Удаленный поиск на DockerHub</li>
                  <li>Скачивание последней версии с DockerHub</li>
                  <li>Создаётся docker-контейнер</li>
                  <li>Присваивается виртуальный IP</li>
                  <li>Открывается порт на этом виртуальном IP</li>
                  <li>Запускается контейнер</li>
                </ol>

                <code>ps aux</code> - список запущенных процессов
              </td>
            </tr>

            <tr>
              <td><h2>Образ</h2> (image)</td>
              <td>Много контейнеров может лежать в образе</td>
              <td><a href="http://hub.docker.com/" target="_blank" rel="noopener noreferrer">http://hub.docker.com/</a>  - репозитории для docker-образов</td>
            </tr>

            <tr>
              <th colspan="3">Docker-команды</th>
            </tr>

            <tr>
              <td>Список комманд</td>
              <td><code>docker</code></td>
              <td></td>
            </tr>

            <tr>
              <td>Шаблон</td>
              <td><code>docker &lt;command&gt; &lt;sub-command&gt; (options)</code></td>
              <td></td>
            </tr>

            <tr>
              <td>Информация</td>
              <td><code>docker info</code></td>
              <td></td>
            </tr>

            <tr>
              <td>Добавить группу и пользователя</td>
              <td>
                <span class="gray">// добавить группу</span>
                <code>sudo groupadd docker</code>
                <span class="gray">// добавить пользователя в группу</span>
                <code>sudo usermod -aG docker <mark>username</mark></code>
                <span class="gray">// узнать username</span>
                <code>sudo whoami</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>Посмотреть образы и/или контейнеры</td>
              <td>
                <span class="gray">// запущенные</span>
                <code><mark>docker ps</mark></code>
                <span class="gray">// установленные</span>
                <code><mark>docker ps -a</mark></code>
                <span class="gray">// посмотреть только образы</span>
                <code>docker <mark>image</mark> ls (--all)</code>
                <span class="gray">// посмотреть только контейнеры</span>
                <code>docker <mark>container</mark> ls (--all)</code>
              </td>
              <td>NAMES - имена контейнеров</td>
            </tr>
            <tr>
              <td>Запустить указанные контейнеры</td>
              <td>
                <code><mark>docker start</mark> cont_name1 cont_name2</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>Остановить контейнеры</td>
              <td>
                <code><mark>docker stop</mark> cont_name1 cont_name2</code>
                <span class="gray">// остановить все </span>
                <code><mark>docker stop</mark> $(docker ps -q)</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>Перезапуск docker</td>
              <td><code><mark>docker service docker restart</mark></code></td>
              <td></td>
            </tr>
            <tr>
              <td><h4>Real use on projects</h4></td>
              <td>
                <code>docker stop $(docker ps -q -a)</code><br>
                <code>docker rm -f</code><br>
                <code>docker-compose pull</code><br>
                <code>docker-compose up -d</code><br>
              </td>
              <td>
                <ol>
                  <li>Остановить контейнеры внутри проекта</li>
                  <li>Удалить</li>
                  <li>Скачать</li>
                  <li>Запустить</li>
                </ol>
              </td>
            </tr>
          </table>
        </div>
      </div>

    </div>
  </div>

  <div class="footer">
    <div class="layout-positioner">
      <p class="footer-text">Разработчик: Евгений Леухин
        <br> EvgenyLeukhin@yandex.ru
      </p>

      <p class="footer-copyright">© 2016 - 2019</p>
    </div>
  </div>

</body>
</html>
